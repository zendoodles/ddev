<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Do local website development on your computer or in the cloud with DDEV."><meta name=author content="Localdev Foundation"><link href=https://ddev.readthedocs.io/en/latest/users/extend/customizing-images/ rel=canonical><link rel=icon href=../../../favicon.png><meta name=generator content="mkdocs-1.3.0, mkdocs-material-8.3.9"><title>Customizing Docker Images - DDEV Docs</title><link rel=stylesheet href=../../../assets/stylesheets/main.1d29e8d0.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.cbb835fc.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../assets/extra.css><script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=light-blue data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#customizing-docker-images class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="DDEV Docs" class="md-header__button md-logo" aria-label="DDEV Docs" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> DDEV Docs </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Customizing Docker Images </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=light-blue data-md-color-accent=indigo aria-hidden=true type=radio name=__palette id=__palette_1> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/drud/ddev title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> drud/ddev </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Start! </a> </li> <li class=md-tabs__item> <a href=../../basics/ class=md-tabs__link> Basics </a> </li> <li class=md-tabs__item> <a href=../database_types/ class=md-tabs__link> Configuration </a> </li> <li class=md-tabs__item> <a href=../customization-extendibility/ class="md-tabs__link md-tabs__link--active"> Extending </a> </li> <li class=md-tabs__item> <a href=../../debugging-profiling/step-debugging/ class=md-tabs__link> Debugging & Profiling </a> </li> <li class=md-tabs__item> <a href=../../providers/ class=md-tabs__link> Hosting integration </a> </li> <li class=md-tabs__item> <a href=../../topics/phpstorm/ class=md-tabs__link> Guides </a> </li> <li class=md-tabs__item> <a href=../../details/offline-usage/ class=md-tabs__link> Details </a> </li> <li class=md-tabs__item> <a href=../../../developers/ class=md-tabs__link> Developers </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="DDEV Docs" class="md-nav__button md-logo" aria-label="DDEV Docs" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> DDEV Docs </label> <div class=md-nav__source> <a href=https://github.com/drud/ddev title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> drud/ddev </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_1 type=checkbox id=__nav_1 checked> <div class="md-nav__link md-nav__link--index "> <a href=../../..>Start!</a> <label for=__nav_1> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Start! data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Start! </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_1_2 type=checkbox id=__nav_1_2 checked> <div class="md-nav__link md-nav__link--index "> <a href=../../install/ >Installing</a> <label for=__nav_1_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Installing data-md-level=2> <label class=md-nav__title for=__nav_1_2> <span class="md-nav__icon md-icon"></span> Installing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../install/docker-installation/ class=md-nav__link> Docker Installation </a> </li> <li class=md-nav__item> <a href=../../install/ddev-installation/ class=md-nav__link> DDEV Installation </a> </li> <li class=md-nav__item> <a href=../../install/performance/ class=md-nav__link> Performance and Mutagen </a> </li> <li class=md-nav__item> <a href=../../install/shell-completion/ class=md-nav__link> Shell Completion & Autocomplete </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../quickstart/ class=md-nav__link> Quickstart for many CMSs </a> </li> <li class=md-nav__item> <a href=../../support/ class=md-nav__link> Support </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_2 type=checkbox id=__nav_2 checked> <div class="md-nav__link md-nav__link--index "> <a href=../../basics/ >Basics</a> <label for=__nav_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Basics data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Basics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../basics/how-ddev-works/ class=md-nav__link> How DDEV Works </a> </li> <li class=md-nav__item> <a href=../../basics/cli-usage/ class=md-nav__link> Using the `ddev` command </a> </li> <li class=md-nav__item> <a href=../../basics/database_management/ class=md-nav__link> Database Management </a> </li> <li class=md-nav__item> <a href=../../basics/troubleshooting/ class=md-nav__link> Troubleshooting </a> </li> <li class=md-nav__item> <a href=../../basics/faq/ class=md-nav__link> Frequently-Asked Questions (FAQ) </a> </li> <li class=md-nav__item> <a href=../../basics/developer-tools/ class=md-nav__link> Built-in Developer Tools </a> </li> <li class=md-nav__item> <a href=../../basics/uninstall/ class=md-nav__link> Uninstalling DDEV </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_3 type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3> Configuration <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Configuration data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Configuration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../database_types/ class=md-nav__link> Database Server Types </a> </li> <li class=md-nav__item> <a href=../../configuration/hooks/ class=md-nav__link> Hooks </a> </li> <li class=md-nav__item> <a href=../additional-hostnames/ class=md-nav__link> Additional Project Hostnames </a> </li> <li class=md-nav__item> <a href=../../configuration/config_yaml/ class=md-nav__link> .ddev/config.yaml options </a> </li> <li class=md-nav__item> <a href=../../configuration/experimental/ class=md-nav__link> Experimental Docker Configurations </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4> Extending <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Extending data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Extending </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../customization-extendibility/ class=md-nav__link> Extending and Customizing Environments </a> </li> <li class=md-nav__item> <a href=../additional-services/ class=md-nav__link> Additional Service Configurations and Add-ons for ddev </a> </li> <li class=md-nav__item> <a href=../custom-compose-files/ class=md-nav__link> Defining an additional service with `docker-compose.*.yaml` </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Customizing Docker Images <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Customizing Docker Images </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#adding-extra-debian-packages-with-webimage_extra_packages-and-dbimage_extra_packages class=md-nav__link> Adding extra Debian packages with webimage_extra_packages and dbimage_extra_packages </a> </li> <li class=md-nav__item> <a href=#how-to-figure-out-what-packages-you-need class=md-nav__link> How to figure out what packages you need </a> </li> <li class=md-nav__item> <a href=#adding-extra-dockerfiles-for-webimage-and-dbimage class=md-nav__link> Adding extra Dockerfiles for webimage and dbimage </a> <nav class=md-nav aria-label="Adding extra Dockerfiles for webimage and dbimage"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#debugging-the-dockerfile-build class=md-nav__link> Debugging the Dockerfile build </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../custom-commands/ class=md-nav__link> Custom (Shell) Commands </a> </li> <li class=md-nav__item> <a href=../in-container-configuration/ class=md-nav__link> In-Container home directory and shell configuration </a> </li> <li class=md-nav__item> <a href=../custom-tls-certificates/ class=md-nav__link> Custom TLS Certificates </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_5 type=checkbox id=__nav_5 checked> <label class=md-nav__link for=__nav_5> Debugging & Profiling <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Debugging & Profiling" data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Debugging & Profiling </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../debugging-profiling/step-debugging/ class=md-nav__link> Step-debugging with Xdebug </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_5_2 type=checkbox id=__nav_5_2 checked> <label class=md-nav__link for=__nav_5_2> Profiling <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Profiling data-md-level=2> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> Profiling </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../debugging-profiling/blackfire-profiling/ class=md-nav__link> Blackfire.io Profiling </a> </li> <li class=md-nav__item> <a href=../../debugging-profiling/xhprof-profiling/ class=md-nav__link> xhprof Profiling </a> </li> <li class=md-nav__item> <a href=../../debugging-profiling/xdebug-profiling/ class=md-nav__link> Xdebug Profiling </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_6 type=checkbox id=__nav_6 checked> <div class="md-nav__link md-nav__link--index "> <a href=../../providers/ >Hosting integration</a> <label for=__nav_6> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="Hosting integration" data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Hosting integration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../providers/acquia/ class=md-nav__link> Acquia Integration </a> </li> <li class=md-nav__item> <a href=../../providers/pantheon/ class=md-nav__link> Pantheon Integration </a> </li> <li class=md-nav__item> <a href=../../providers/platform/ class=md-nav__link> Platform.sh Integration </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_7 type=checkbox id=__nav_7 checked> <label class=md-nav__link for=__nav_7> Guides <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Guides data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Guides </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../topics/phpstorm/ class=md-nav__link> PhpStorm Configuration and Integration </a> </li> <li class=md-nav__item> <a href=../../topics/sharing/ class=md-nav__link> Sharing your project with others </a> </li> <li class=md-nav__item> <a href=../../topics/webserver/ class=md-nav__link> Webserver-Specific Help and Techniques </a> </li> <li class=md-nav__item> <a href=../../topics/whats_in_ddev_dir/ class=md-nav__link> What's all that stuff in the `.ddev` directory? </a> </li> <li class=md-nav__item> <a href=../../topics/cms_specific_help/ class=md-nav__link> Controlling CMS Settings Files in DDEV </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_8 type=checkbox id=__nav_8 checked> <label class=md-nav__link for=__nav_8> Details <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Details data-md-level=1> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Details </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../details/offline-usage/ class=md-nav__link> Using DDEV offline </a> </li> <li class=md-nav__item> <a href=../../details/opting-in/ class=md-nav__link> Opting in </a> </li> <li class=md-nav__item> <a href=../../details/alternate-uses/ class=md-nav__link> Alternate Uses for DDEV </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_9 type=checkbox id=__nav_9 checked> <div class="md-nav__link md-nav__link--index "> <a href=../../../developers/ >Developers</a> <label for=__nav_9> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Developers data-md-level=1> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Developers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../developers/building-contributing/ class=md-nav__link> Building, Testing, and Contributing </a> </li> <li class=md-nav__item> <a href=../../../developers/buildkite-testmachine-setup/ class=md-nav__link> Buildkite Test Agent Setup </a> </li> <li class=md-nav__item> <a href=../../../developers/github-selfhosted-setup/ class=md-nav__link> Github Self-Hosted Agent Setup </a> </li> <li class=md-nav__item> <a href=../../../developers/project-types/ class=md-nav__link> Adding New Project Types </a> </li> <li class=md-nav__item> <a href=../../../developers/release-management/ class=md-nav__link> DDEV Release Management and Docker Images </a> </li> <li class=md-nav__item> <a href=../../../developers/styleguide/ class=md-nav__link> Styleguide </a> </li> <li class=md-nav__item> <a href=../../../developers/testing-docs/ class=md-nav__link> Working on the docs </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/drud/ddev/blob/master/docs/content/users/extend/customizing-images.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg> </a> <h1 id=customizing-docker-images>Customizing Docker Images<a class=headerlink href=#customizing-docker-images title="Permanent link">&para;</a></h1> <p>It's common to have a requirement for the web or db images which is not bundled in them by default. There are two easy ways to extend these docker images:</p> <ul> <li><code>webimage_extra_packages</code> and <code>dbimage_extra_packages</code> in .ddev/config.yaml</li> <li>An add-on Dockerfile in your project's <code>.ddev/web-build</code> or <code>.ddev/db-build</code></li> </ul> <h2 id=adding-extra-debian-packages-with-webimage_extra_packages-and-dbimage_extra_packages>Adding extra Debian packages with webimage_extra_packages and dbimage_extra_packages<a class=headerlink href=#adding-extra-debian-packages-with-webimage_extra_packages-and-dbimage_extra_packages title="Permanent link">&para;</a></h2> <p>You can add extra Debian packages if that's all that is needed with lines like this in <code>.ddev/config.yaml</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nt>webimage_extra_packages</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>php-yaml</span><span class="p p-Indicator">,</span><span class=w> </span><span class=nv>php7.3-tidy</span><span class="p p-Indicator">]</span><span class=w></span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=nt>dbimage_extra_packages</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>telnet</span><span class="p p-Indicator">,</span><span class=w> </span><span class=nv>netcat</span><span class="p p-Indicator">]</span><span class=w></span>
</code></pre></div> <p>Then the additional packages will be built into the containers during <code>ddev start</code></p> <h2 id=how-to-figure-out-what-packages-you-need>How to figure out what packages you need<a class=headerlink href=#how-to-figure-out-what-packages-you-need title="Permanent link">&para;</a></h2> <p>The web container is a Debian image, and its PHP distributions are packaged (thank you!) by <a href=https://deb.sury.org/ ><code>deb.sury.org</code></a>.</p> <p>If you need a PHP extension, most PHP extensions are built in the <code>deb.sury.org</code> distribution. You can google the extension you want, or download and search the <a href=https://packages.sury.org/php/dists/buster/main/binary-amd64/Packages>Packages</a> list from the <code>sury</code> distribution. For example, the <code>bcmath</code> PHP extension is provided by "php-bcmath". Many packages have version-specific names, for example <code>php7.3-tidy</code>.</p> <p>If you need a package that is <em>not</em> a PHP package, you can view and search standard Debian packages at <a href=https://packages.debian.org/stable/ >packages.debian.org/stable</a>, or just use google.</p> <p>To test that a package will do what you want, you can <code>ddev ssh</code> and then <code>sudo apt-get update &amp;&amp; sudo apt-get install &lt;package&gt;</code> to verify that you can install it and you get what you need. A php extension may require <code>killall -USR2 php-fpm</code> to take effect. After you've tried that, you can add the package to <code>webimage_extra_packages</code>.</p> <h2 id=adding-extra-dockerfiles-for-webimage-and-dbimage>Adding extra Dockerfiles for webimage and dbimage<a class=headerlink href=#adding-extra-dockerfiles-for-webimage-and-dbimage title="Permanent link">&para;</a></h2> <p>For more complex requirements, you can add:</p> <ul> <li><code>.ddev/web-build/Dockerfile</code></li> <li><code>.ddev/web-build/Dockerfile.*</code></li> <li><code>.ddev/db-build/Dockerfile</code></li> <li><code>.ddev/db-build/Dockerfile.*</code></li> </ul> <p>These files' content will be inserted into the constructed Dockerfile for each image. They are inserted <em>after</em> most of the rest of the things that are done to build the image, and are done in alpha order, so <code>Dockerfile</code> is inserted first, followed by <code>Dockerfile.*</code> in alpha order.</p> <p>For certain use cases, you might need to add stuff very early on the Dockerfile (i.e. proxy settings, SSL termination, etc.) you can also create:</p> <ul> <li><code>.ddev/web-build/pre.Dockerfile.*</code></li> <li><code>.ddev/db-build/pre.Dockerfile.*</code></li> </ul> <p>These are inserted <em>before</em> everything else.</p> <p>You can examine the resultant Dockerfile (which should not be changed as it is generated) at <code>.ddev/.webimageBuild/Dockerfile</code> and you can force a rebuild with <code>ddev debug refresh</code>.</p> <p>Examples of possible Dockerfiles are given in <code>.ddev/web-build/Dockerfile.example</code> and <code>.ddev/db-build/Dockerfile.example</code> (these examples are created in your project when you <code>ddev config</code> the project).</p> <p>You can use the <code>.ddev/*-build</code> directory as the Docker "context" directory as well. So for example if a file named README.txt exists in <code>.ddev/web-build</code>, you can use <code>ADD README.txt /</code> in the Dockerfile.</p> <p>An example web image <code>.ddev/web-build/Dockerfile</code> might be:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=k>RUN</span><span class=w> </span>npm install -g gatsby-cli
</code></pre></div> <p>Another example would be installing phpcs globally (see <a href=https://stackoverflow.com/questions/61870801/add-global-phpcs-and-drupal-coder-to-ddev-in-custom-dockerfile/61870802#61870802>Stack Overflow answer</a>):</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=k>ENV</span><span class=w> </span><span class=nv>COMPOSER_HOME</span><span class=o>=</span>/usr/local/composer
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=c># We try to avoid when possible relying on composer to download global, so in PHPCS case we can use the phar.</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=k>RUN</span><span class=w> </span>curl -L https://squizlabs.github.io/PHP_CodeSniffer/phpcs.phar -o /usr/local/bin/phpcs <span class=o>&amp;&amp;</span> chmod +x /usr/local/bin/phpcs
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=k>RUN</span><span class=w> </span>curl -L https://squizlabs.github.io/PHP_CodeSniffer/phpcbf.phar -o /usr/local/bin/phpcbf <span class=o>&amp;&amp;</span> chmod +x /usr/local/bin/phpcbf
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=c># If however we need to download a package, we use `cgr` for that.</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=k>RUN</span><span class=w> </span>composer global require consolidation/cgr
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=k>RUN</span><span class=w> </span><span class=nv>$COMPOSER_HOME</span>/vendor/bin/cgr drupal/coder:^8.3.1
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=k>RUN</span><span class=w> </span><span class=nv>$COMPOSER_HOME</span>/vendor/bin/cgr dealerdirect/phpcodesniffer-composer-installer
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=c># Register Drupal&#39;s code sniffer rules.</span>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=k>RUN</span><span class=w> </span>phpcs --config-set installed_paths <span class=nv>$COMPOSER_HOME</span>/global/drupal/coder/vendor/drupal/coder/coder_sniffer --verbose
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=c># Make Codesniffer config file writable for ordinary users in container.</span>
<a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=k>RUN</span><span class=w> </span>chmod <span class=m>666</span> /usr/local/bin/CodeSniffer.conf
<a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a><span class=c># Make COMPOSER_HOME writable if regular users need to use it.</span>
<a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a><span class=k>RUN</span><span class=w> </span>chmod -R ugo+rw <span class=nv>$COMPOSER_HOME</span>
<a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a><span class=c># Now turn it off, because ordinary users will want to be using the default</span>
<a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a><span class=k>ENV</span><span class=w> </span><span class=nv>COMPOSER_HOME</span><span class=o>=</span><span class=s2>&quot;&quot;</span>
</code></pre></div> <p><strong>Remember that the Dockerfile is building a docker image that will be used later with ddev.</strong> At the time the Dockerfile is executing, your code is not mounted and the container is not running, it's just being built. So for example, an <code>npm install</code> in /var/www/html will not do anything useful because the code is not there at image building time.</p> <h3 id=debugging-the-dockerfile-build>Debugging the Dockerfile build<a class=headerlink href=#debugging-the-dockerfile-build title="Permanent link">&para;</a></h3> <p>It can be complicated to figure out what's going on when building a Dockerfile, and even more complicated when you're seeing it go by as part of <code>ddev start</code>.</p> <ol> <li>Use <code>ddev ssh</code> first of all to pioneer the steps you want to take. You can just do all the things you need to do there, and see if it works. If doing something that affects PHP you may need to <code>sudo killall -USR2 php-fpm</code> for it to take effect.</li> <li>Put the steps you pioneered into <code>.ddev/web-build/Dockerfile</code> as above.</li> <li>If you can't figure out what's failing or why, then <code>~/.ddev/bin/docker-compose -f .ddev/.ddev-docker-compose-full.yaml build web --no-cache --progress=plain</code> to see what's happening during the Dockerfile build.</li> </ol> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">July 16, 2022</span> </small> </div> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../custom-compose-files/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Defining an additional service with `docker-compose.*.yaml`" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Defining an additional service with `docker-compose.*.yaml` </div> </div> </a> <a href=../custom-commands/ class="md-footer__link md-footer__link--next" aria-label="Next: Custom (Shell) Commands" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Custom (Shell) Commands </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Localdev Foundation </div> </div> <div class=md-social> <a href=https://github.com/drud/ddev target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://discord.gg/hCZFfAMc5k target=_blank rel=noopener title=discord.gg class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485.065 485.065 0 0 0 404.081 32.03a1.816 1.816 0 0 0-1.923.91 337.461 337.461 0 0 0-14.9 30.6 447.848 447.848 0 0 0-134.426 0 309.541 309.541 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.689 483.689 0 0 0-119.688 37.107 1.712 1.712 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016 0 0 0 .765 1.375 487.666 487.666 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348.2 348.2 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321.173 321.173 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251.047 251.047 0 0 0 9.109-7.137 1.819 1.819 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.812 1.812 0 0 1 1.924.233 234.533 234.533 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.407 301.407 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391.055 391.055 0 0 0 30.014 48.815 1.864 1.864 0 0 0 2.063.7A486.048 486.048 0 0 0 610.7 405.729a1.882 1.882 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541ZM222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241Zm195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241Z"/></svg> </a> <a href=https://stackoverflow.com/tags/ddev target=_blank rel=noopener title=stackoverflow.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 384 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M290.7 311 95 269.7 86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8 153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 300zM262 32l-32 24 119.3 160.3 32-24zm20.5 328h-200v39.7h200zm39.7 80H42.7V320h-40v160h359.5V320h-40z"/></svg> </a> <a href="https://twitter.com/search?q=%23ddev&src=unknown&f=live" target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.expand", "navigation.indexes", "navigation.instant", "navigation.sections", "navigation.tabs", "navigation.top", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.6c7ad80a.min.js></script> <script src=../../../assets/jquery-3.5.1.min.js></script> </body> </html>